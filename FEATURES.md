# GroupChat 功能清单

**版本**: v3.3.0
**更新时间**: 2026-01-15

本文档列出 GroupChat 的所有功能，按类别组织，标注版本和成熟度。

---

## 📋 功能分类

- [核心系统](#核心系统)
- [AI 增强功能](#ai-增强功能)
- [记忆与检索](#记忆与检索)
- [评测与质量保证](#评测与质量保证)
- [UI/UX 功能](#uiux-功能)
- [数据管理](#数据管理)
- [配置与设置](#配置与设置)
- [实验性功能](#实验性功能)

---

## 核心系统

### 1. CrewAI 多 Agent 架构

**功能描述**：基于 CrewAI 框架的真正多智能体系统，每个角色都是独立的 Agent。

**首次发布**：v3.0.0 (2026-01-07)

**成熟度**：✅ **Stable**

**主要特性**：
- [x] 每个角色是独立的 CrewAI Agent
- [x] Agent 拥有独立的记忆和上下文
- [x] 支持 2-8 个 Agent 同时运行
- [x] 自动降级到传统模式（如果 CrewAI 失败）

**配置位置**：侧边栏 → "🤖 启用 CrewAI 多 Agent 系统"

**相关文档**：[CREWAI_GUIDE.md](CREWAI_GUIDE.md)

---

### 2. 智能发言决策

**功能描述**：Agent 自主判断是否需要发言，而非机械轮流。

**首次发布**：v3.0.0 (2026-01-07)

**成熟度**：✅ **Stable**

**工作原理**：
- Agent 评估当前对话上下文
- 决定是否有话要说
- 输出发言内容或 "PASS"（沉默）

**优势**：
- ✅ 对话更自然
- ✅ 避免无意义发言
- ✅ 模拟真实群聊场景

**相关文档**：[README_v3.md](README_v3.md#核心功能详解)

---

### 3. 独立记忆系统

**功能描述**：每个 Agent 拥有完整的对话记忆，包括群聊和私聊。

**首次发布**：v2.2.0 (2026-01-07)

**成熟度**：✅ **Stable**

**记忆类型**：
- **群聊记忆**：所有角色可见的公开对话
- **私聊记忆**：只有该角色知道的私密信息

**记忆隔离**：
- [x] 私聊内容不会泄露给其他角色
- [x] Agent 可以巧妙利用私聊信息

**查看方式**：侧边栏 → "🧠 角色记忆查看"

**相关文档**：[USER_MANUAL.md](USER_MANUAL.md#24-记忆系统)

---

### 4. 自主对话模式

**功能描述**：让 Agent 们自己互动，无需用户输入。

**首次发布**：v2.3.0 (2026-01-07)

**成熟度**：✅ **Stable**

**使用方法**：
1. 侧边栏 → "🎭 自主对话控制"
2. 设置轮数（1-5轮）
3. 点击"🎭 继续聊"

**应用场景**：
- 观察角色互动
- 推进剧情发展
- 测试角色设定

**相关文档**：[USER_MANUAL.md](USER_MANUAL.md#23-自主对话模式)

---

### 5. 群聊模式

**功能描述**：所有 AI 角色在同一个聊天室中互动。

**首次发布**：v1.0.0

**成熟度**：✅ **Stable**

**特点**：
- [x] 多个角色同时在线
- [x] 用户可以参与对话
- [x] 角色可以互相回应

---

### 6. 私聊模式

**功能描述**：与单个 AI 角色进行一对一私密对话。

**首次发布**：v2.0.0

**成熟度**：✅ **Stable**

**使用方式**：侧边栏 → "私聊管理" → 选择角色

**价值**：
- 传递秘密信息
- 获取独家情报
- 建立角色关系

**相关文档**：[USER_MANUAL.md](USER_MANUAL.md#22-私聊模式)

---

## AI 增强功能

### 7. Few-shot 剧本模版

**功能描述**：使用专业话剧风格模版，提升对话质量。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：✅ **Stable**

**可用模版**：
- [x] 悬疑话剧风格（`drama_suspense.json`）
- [x] 喜剧话剧风格（`drama_comedy.json`）
- [x] 现实主义话剧风格（`drama_realism.json`）

**模版包含**：
- 语言特征（词汇、句式、语气）
- Few-shot 对话示例
- 反面示例对比

**启用方式**：侧边栏 → "📚 Few-shot 剧本模版"

**相关文档**：[EVALUATION_SYSTEM_GUIDE.md](EVALUATION_SYSTEM_GUIDE.md#📚-few-shot-剧本模版)

---

### 8. 模版管理系统

**功能描述**：加载、选择和应用话剧风格模版到 Prompt 中。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：✅ **Stable**

**功能**：
- [x] 自动加载 `templates/` 目录下的模版
- [x] UI 选择模版
- [x] 动态应用到 Prompt
- [x] 支持自定义模版添加

**技术实现**：`template_manager.py`

---

## 记忆与检索

### 9. RAG 记忆检索

**功能描述**：使用 RAG（检索增强生成）技术，从历史对话中检索相关信息。

**首次发布**：v3.2.0 (2026-01-10)

**成熟度**：✅ **Stable**

**核心能力**：
- [x] 语义检索（理解含义相似的对话）
- [x] 关键词检索（精确匹配）
- [x] 混合检索（结合上述两种）
- [x] 支持长对话（>200 条消息）

**技术栈**：
- ChromaDB（向量数据库）
- Sentence Transformers（Embedding 模型）
- Google Embedding API

**启用方式**：侧边栏 → "🧠 启用 RAG 记忆检索"

**相关文档**：[RAG_GUIDE.md](RAG_GUIDE.md)

---

### 10. 向量数据库

**功能描述**：本地 ChromaDB 数据库，存储对话向量。

**首次发布**：v3.2.0 (2026-01-10)

**成熟度**：✅ **Stable**

**存储位置**：`./chroma_db/` 目录

**数据管理**：
- [x] 自动创建数据库
- [x] 增量更新（新对话自动添加）
- [x] 手动清理（删除 `./chroma_db` 目录）

---

### 11. 混合检索策略

**功能描述**：结合关键词和语义两种检索方式。

**首次发布**：v3.2.0 (2026-01-10)

**成熟度**：✅ **Stable**

**策略**：
- **关键词检索**（40%权重）：快速定位包含特定词汇的对话
- **语义检索**（60%权重）：理解语义相似的对话
- **重排序**：综合两种结果，返回最相关的记忆

**相关文档**：[RAG_GUIDE.md](RAG_GUIDE.md#混合检索策略)

---

## 评测与质量保证

### 12. 评测体系

**功能描述**：量化评估对话质量，提供三大核心指标。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：✅ **Stable**

**核心指标**：
- **CPD**（Character Personality Divergence）：人设离散度，衡量角色差异
- **DE**（Dialogue Efficiency）：对话有效率，衡量信息密度
- **OOC Rate**（Out of Character Rate）：出戏率，检测人设一致性

**运行方式**：
```bash
python run_evaluation.py --api-key YOUR_KEY
```

**相关文档**：[EVALUATION_SYSTEM_GUIDE.md](EVALUATION_SYSTEM_GUIDE.md)

---

### 13. 测试数据集

**功能描述**：标注好的测试场景，用于评估系统质量。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：✅ **Stable**

**数据量**：
- 8 个测试场景
- 5 个高质量样本
- 2 个低质量样本
- 1 个中等质量样本

**场景类型**：悬疑、商业、创意、日常等

**文件位置**：`test_dataset.json`

---

### 14. Bad Case 库

**功能描述**：系统化整理的典型问题案例库。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：✅ **Stable**

**案例分类**：
- 角色性格趋同（2个案例）
- 机械轮流发言（2个案例）
- 对话重复无效（2个案例）
- Out of Character（3个案例）
- 记忆混乱（2个案例）

**每个案例包含**：
- 问题描述
- 不良示例
- 改进示例
- 根本原因
- 解决方案

**文件位置**：`bad_case_library.json`

---

### 15. 自动化评测脚本

**功能描述**：批量运行评测，生成报告。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：✅ **Stable**

**功能**：
- [x] 批量评测多个场景
- [x] 生成详细报告
- [x] 按质量分组统计
- [x] 保存评测结果

**文件位置**：`run_evaluation.py`

---

## UI/UX 功能

### 16. Streamlit Web 界面

**功能描述**：基于 Streamlit 的直观 Web UI。

**首次发布**：v1.0.0

**成熟度**：✅ **Stable**

**主要组件**：
- 主聊天区域
- 侧边栏配置
- 状态提示
- 实时消息显示

---

### 17. 预设管理

**功能描述**：快速加载预配置的场景和角色。

**首次发布**：v2.0.0

**成熟度**：✅ **Stable**

**功能**：
- [x] 导入预设文件（JSON）
- [x] 导出当前配置
- [x] 内置示例预设（古堡、创业、修仙）

**文件格式**：
```json
{
  "scene": "场景描述",
  "characters": [
    {"name": "角色名", "personality": "性格"}
  ]
}
```

---

### 18. 对话导出/加载

**功能描述**：保存和恢复对话历史。

**首次发布**：v2.1.0

**成熟度**：✅ **Stable**

**功能**：
- [x] 导出对话为 JSON 文件
- [x] 加载之前的对话
- [x] 继续之前的会话

---

### 19. 角色记忆查看

**功能描述**：查看每个角色的完整记忆。

**首次发布**：v2.2.0

**成熟度**：✅ **Stable**

**查看内容**：
- 群聊记录（绿色）
- 私聊记录（蓝色）
- 时间顺序排列

**使用方式**：侧边栏 → "🧠 角色记忆查看"

---

### 20. RAG 检索结果展示

**功能描述**：显示 RAG 检索到的相关历史对话。

**首次发布**：v3.2.0 (2026-01-10)

**成熟度**：✅ **Stable**

**显示内容**：
- 相关对话片段
- 相似度评分
- 检索策略说明

**查看方式**：侧边栏 → "RAG 检索结果"

---

### 21. 实时状态提示

**功能描述**：显示 Agent 当前状态和生成进度。

**首次发布**：v2.1.0

**成熟度**：✅ **Stable**

**状态类型**：
- 思考中...
- 生成回复...
- 完成

---

## 数据管理

### 22. 记忆清空

**功能描述**：清空所有角色的对话记忆。

**首次发布**：v2.2.0

**成熟度**：✅ **Stable**

**使用方式**：侧边栏 → "记忆管理" → "清空所有记忆"

**影响**：
- 所有角色"失忆"
- 对话从零开始
- 不影响导出的历史记录

---

### 23. 对话历史管理

**功能描述**：管理对话历史的存储和加载。

**首次发布**：v2.1.0

**成熟度**：✅ **Stable**

**功能**：
- [x] 导出当前对话
- [x] 导入历史对话
- [x] 清空对话历史

---

## 配置与设置

### 24. API 配置

**功能描述**：配置 Gemini API 连接。

**首次发布**：v1.0.0

**成熟度**：✅ **Stable**

**配置项**：
- API Key
- 模型选择（gemini-2.0-flash-exp / 1.5-pro / 1.5-flash）
- Temperature（0.0-1.0）

**位置**：侧边栏 → "API 配置"

---

### 25. 场景和角色设置

**功能描述**：自定义场景描述和角色人设。

**首次发布**：v1.0.0

**成熟度**：✅ **Stable**

**配置项**：
- 场景描述
- 角色数量（2-8个）
- 每个角色的名字和性格

---

### 26. 用户角色设置

**功能描述**：自定义用户在对话中的角色身份。

**首次发布**：v2.0.0

**成熟度**：✅ **Stable**

**默认**："你"

**可自定义**：名字 + 性格

---

### 27. 模式切换

**功能描述**：在 CrewAI 模式和传统模式之间切换。

**首次发布**：v3.0.0

**成熟度**：✅ **Stable**

**模式对比**：
| 特性 | CrewAI 模式 | 传统模式 |
|------|-----------|---------|
| Agent 独立性 | 独立 | 共享 Prompt |
| 发言机制 | 自主决策 | 强制轮流 |
| 记忆 | 独立 | 共享 |

---

## 实验性功能

### 28. 导演系统（Beta）

**功能描述**：引入管理层 Agent（编剧、导演、审核），提升对话质量。

**首次发布**：v3.3.0 (2026-01-15)

**成熟度**：⚠️ **Beta/实验性**

**架构**：
- **编剧 Agent**：规划剧情走向
- **导演 Agent**：分配角色任务
- **审核 Agent**：质量检查

**四阶段流程**：
1. 编剧规划（剧情目标）
2. 导演分配（角色任务）
3. 角色表演（生成对话）
4. 审核检查（质量把关 + 重试机制）

**运行方式**：
```bash
python director_system.py
```

**未来计划**：
- [ ] 集成到 `app.py`
- [ ] 添加 UI 控制开关
- [ ] 优化响应速度

**相关文档**：[DIRECTOR_SYSTEM_GUIDE.md](DIRECTOR_SYSTEM_GUIDE.md)（待创建）

---

### 29. 轮流发言模式

**功能描述**：一次只有一个角色发言，按顺序轮流。

**首次发布**：v3.1.0 (2026-01-08)

**成熟度**：✅ **Stable**

**优势**：
- 保证对话连贯性
- 避免同时多个角色发言
- 更贴近真实对话节奏

**配置**：侧边栏 → 相关设置

---

### 30. 预设优化加载

**功能描述**：加载预设时不刷新页面，体验更流畅。

**首次发布**：v3.1.0 (2026-01-08)

**成熟度**：✅ **Stable**

---

## 功能统计

### 按成熟度分类

| 成熟度 | 数量 | 功能 |
|-------|------|------|
| ✅ Stable | 29 | 绝大部分功能 |
| ⚠️ Beta | 1 | 导演系统 |
| 🚧 Planned | 4 | v3.4-v4.0 计划功能 |

### 按版本分布

| 版本 | 新增功能数 |
|------|----------|
| v1.0 | 5 |
| v2.x | 8 |
| v3.0 | 4 |
| v3.1 | 2 |
| v3.2 | 3 |
| v3.3 | 8 |
| **总计** | **30** |

---

## 未来计划功能

### v3.4.0（计划中）- 导演系统集成

**预计发布**：2026-01-20

- [ ] 导演系统集成到主应用
- [ ] UI 控制开关
- [ ] 性能优化
- [ ] 更多剧本模版（科幻、武侠）

### v3.5.0（未来计划）- 多模态支持

**预计发布**：2026-02

- [ ] 图像输入支持
- [ ] 场景图片理解
- [ ] 角色头像生成
- [ ] 语音输入/输出

### v4.0.0（远期计划）- 云端协作

**预计发布**：2026-Q2

- [ ] 多用户协作模式
- [ ] 云端对话保存
- [ ] 角色市场（分享自定义角色）
- [ ] Web API 接口

---

## 功能对比（版本演进）

### v1.0 → v2.0
- ✅ 添加私聊模式
- ✅ 添加预设管理
- ✅ 添加对话导出

### v2.0 → v3.0
- ✅ 从角色扮演 → 真多 Agent
- ✅ 添加智能发言决策
- ✅ 添加自主对话模式
- ✅ 添加独立记忆系统

### v3.0 → v3.2
- ✅ 添加 RAG 记忆检索
- ✅ 支持长对话（>200 条）
- ✅ 添加向量数据库

### v3.2 → v3.3
- ✅ 添加评测体系（CPD、DE、OOC）
- ✅ 添加 Few-shot 模版系统
- ✅ 添加 Bad Case 库
- ✅ 添加导演系统（实验性）

---

## 功能交叉索引

### 按使用频率

| 频率 | 功能 |
|------|------|
| **高频** | 群聊模式、API 配置、预设管理 |
| **中频** | 私聊模式、记忆查看、CrewAI 模式 |
| **低频** | RAG 检索、Few-shot 模版、评测体系 |

### 按技术复杂度

| 复杂度 | 功能 |
|--------|------|
| **简单** | 对话导出、记忆清空、场景设置 |
| **中等** | 私聊模式、预设管理、轮流发言 |
| **复杂** | CrewAI 系统、RAG 检索、评测体系、导演系统 |

---

## 相关文档

- [用户手册](USER_MANUAL.md) - 所有功能的详细使用说明
- [技术文档](API.md) - 功能的技术实现细节
- [版本信息](VERSION.md) - 功能的版本发布历史
- [更新日志](CHANGELOG.md) - 功能的完整变更记录

---

**当前版本 v3.3.0 共有 30 个功能，其中 29 个 Stable，1 个 Beta！** ✅
